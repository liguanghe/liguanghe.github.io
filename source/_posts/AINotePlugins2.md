---
title:  plugins2. 开始搭建。
date: 2017/4/22 18:35:32
categories: 
- note
tags: 
- GPT
- plugins

---

开始工作
创建一个插件需要3个步骤：

建立一个API
以OpenAPI yaml或JSON格式记录API。
创建一个JSON清单文件，为插件定义相关的元数据。
本节其余部分的重点是通过定义OpenAPI规范和清单文件来创建一个todo list插件。

探索示例插件
探索涵盖多种用例和认证方法的示例插件。
插件清单
每个插件都需要ai-plugin.json文件，该文件需要托管在API的域名上。例如，一家名为example.com的公司将使插件的JSON文件可以通过https://example.com，因为那是他们的API的托管地。当你通过ChatGPT用户界面安装插件时，在后端我们会寻找一个位于/.known/ai-plugin.json的文件。为了让ChatGPT与您的插件连接，/.known文件夹是必需的，而且必须存在于您的域名中。如果没有找到文件，该插件就不能被安装。对于本地开发，你可以使用HTTP，但如果你要指向远程服务器，则需要HTTPS。


OpenAPI定义
下一步是建立OpenAPI规范来记录API。除了OpenAPI规范和清单文件中定义的内容外，ChatGPT中的模型对你的API一无所知。这意味着，如果你有一个广泛的API，你不需要向模型暴露所有的功能，可以选择特定的端点。例如，如果你有一个社交媒体 API，你可能想让模型通过 GET 请求访问网站上的内容，但为了减少垃圾邮件的机会，要阻止模型对用户的帖子进行评论。

OpenAPI规范是坐落在你的API之上的包装器。一个基本的OpenAPI规范看起来像下面这样：

我们首先定义规范版本、标题、描述和版本号。当在ChatGPT中运行查询时，它将查看在信息部分定义的描述，以确定该插件是否与用户查询有关。你可以在编写描述部分阅读更多关于提示的内容。

请牢记OpenAPI规范中的以下限制，这些限制可能会改变：

API规范中每个API端点描述/摘要字段最多200个字符
API规范中的每个API参数描述字段最多200个字符
由于我们是在本地运行这个例子，我们要把服务器设置为指向你的localhost URL。OpenAPI规范的其余部分遵循传统的OpenAPI格式，你可以通过各种在线资源了解更多关于OpenAPI的格式。也有很多工具可以根据你的底层API代码自动生成OpenAPI规范。

运行一个插件
一旦你为你的API创建了一个API、清单文件和OpenAPI规范，你现在就可以通过ChatGPT用户界面连接该插件。您的插件可能在两个不同的地方运行，要么在本地的开发环境中，要么在远程服务器上。

如果你有一个本地版本的API在运行，你可以把插件的界面指向你的本地主机服务器。要将插件与ChatGPT连接起来，请导航到插件商店，选择 "开发你自己的插件"。输入你的本地主机和端口号（如localhost:3333）。请注意，目前本地主机的开发只支持无授权类型。

如果该插件在远程服务器上运行，你将需要首先选择 "开发你自己的插件 "来设置它，然后选择 "安装一个未经验证的插件 "来为自己安装它。你可以简单地将插件清单文件添加到yourdomain.com/.known/路径中，并开始测试你的API。然而，对于清单文件的后续更改，您必须将新的更改部署到您的公共网站，这可能需要很长的时间。在这种情况下，我们建议设置一个本地服务器，作为您的API的代理。这可以让您快速对您的OpenAPI规格和清单文件进行原型更改。

为您的公共API设置一个本地代理
编写描述
当用户进行可能是潜在请求的查询时，该模型会查看 OpenAPI 规范中的端点描述以及清单文件中的 description_for_model。就像提示其他语言模型一样，你要测试多个提示和描述，看看什么最有效。

OpenAPI 规范本身就是一个很好的地方，可以给模型提供关于您的 API 的各种细节的信息--哪些功能是可用的，有哪些参数，等等。除了为每个字段使用富有表现力的、信息丰富的名称外，规范还可以为每个属性包含 "描述 "字段。这些可以用来提供自然语言的描述，例如，一个函数做什么或一个查询字段期望得到什么信息。模型将能够看到这些，它们将指导它使用API。如果一个字段只限于某些值，你也可以提供一个带有描述性类别名称的 "枚举"。

description_for_model属性让你可以自由地指导模型如何普遍使用你的插件。总的来说，ChatGPT背后的语言模型有很强的能力理解自然语言和遵循指令。因此，这是一个很好的地方，可以把你的插件做什么以及模型应该如何正确使用它的一般指示放进去。使用自然语言，最好是用简洁而又描述性的客观语气。你可以看看一些例子，了解一下这应该是什么样子。我们建议在description_for_model中以 "Plugin for ... "开始，然后列举你的API提供的所有功能。

最佳实践
以下是一些最佳实践，在编写你的OpenAPI规范中的description_for_model和描述时，以及在设计你的API响应时，都要遵循：

你的描述不应该试图控制ChatGPT的情绪、个性或确切的反应。ChatGPT的设计是为了给插件写适当的响应。

不好的例子：

当用户要求查看他们的todo列表时，总是用 "我能够找到你的todo列表！"来回应！你有[x]个todos：[在这里列出todos]。如果你愿意的话，我可以添加更多的待办事项！"

好例子：

[这个不需要说明］

当用户没有要求使用你的插件的特定服务类别时，你的描述不应该鼓励ChatGPT使用该插件。

坏的例子：

每当用户提到任何类型的任务或计划时，就问他们是否愿意使用TODOs插件来添加一些东西到他们的todo列表。

好的例子：

TODO列表可以添加、删除和查看用户的TODO。

你的描述不应该规定ChatGPT使用该插件的具体触发因素。ChatGPT的设计是在适当的时候自动使用您的插件。

不好的例子：

当用户提到一个任务时，回应说 "你想让我把这个加入你的TODO列表吗？说'是'就可以继续。"

好的例子：

[这个不需要说明]。

插件API响应应该返回原始数据而不是自然语言响应，除非有必要。ChatGPT将使用返回的数据提供自己的自然语言响应。

坏的例子：

我能够找到你的待办事项清单！你有两个待办事项！你有两个任务：买菜和遛狗。如果你愿意的话，我可以添加更多的任务！

好的例子：

{ "toodos"： [ "买菜", "遛狗" ] }

调试
默认情况下，聊天不会显示插件调用和其他没有浮现在用户面前的信息。为了更全面地了解模式是如何与您的插件互动的，您可以在与插件互动后点击插件名称上的向下箭头，查看请求和响应情况。

A模式

通过www.DeepL.com/Translator（免费版）翻译